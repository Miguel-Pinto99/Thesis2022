#: include Gps.kv
#:import Factory kivy.factory.Factory
#:import get_color_from_hex kivy.utils.get_color_from_hex

<MyPopup@Popup>:
    auto_dismiss: False
    Button:
        text: 'Close me!'
        #on_release: root.dismiss()




<WindowManager>:
    id:wm

    MyLayout:
        name: "main_screen"
        manager:wm

    ReverseLayout:
        name: "reverse_screen"
        manager:wm

    CloseLayout:
        name: "close_screen"
        manager:wm

<CloseLayout>:
    name: "close_screen"
    GridLayout:
        size: root.width, root.height
        cols:1
        padding: 30

        GridLayout:
            col_default_width:1
            col_default_height:0.2
            #col_force_default: True
            size_hint_y: 0.5
            padding: 30
            spacing: 20
            cols:3
            rows:1


            MDCard:
                md_bg_color: app.theme_cls.divider_color
                orientation: 'horizontal'
                MDGridLayout:
                    padding: 30
                    spaceing: 30
                    rows:1
                    cols:2

                    MDLabel:
                        id: dist4
                        text: "Bateria %"
                        font_size: 65
                        font_name: app.font1
                        size_hint_x: .65
                        size_hint_y: 1

                    MDLabel:
                        id: dist4
                        text: "23"
                        font_name: app.font1
                        font_size: 110
                        size_hint_x: .2
                        size_hint_y: 1



            MDCard:
                md_bg_color: app.theme_cls.divider_color
                orientation: 'horizontal'
                MDGridLayout:
                    padding: 30
                    spacing: 30
                    rows:1
                    cols:2

                    MDLabel:
                        text: "255"
                        font_name: app.font1
                        font_size: 200
                        halign:"center"
                        id: velocidade_label3
                        size_hint_x: .65
                        size_hint_y: 1

                    MDLabel:
                        text: "Km/h"
                        font_size: 55
                        font_name: app.font1
                        size_hint_x: .20
                        size_hint_y: 1



            MDCard:
                md_bg_color: app.theme_cls.divider_color
                orientation: 'horizontal'
                style: "outlined"


                MDIcon:

                    icon: "car-shift-pattern"
                    halign:"center"
                    font_size: 124
                    size_hint_x: .5
                    size_hint_y: 1


                MDIcon:
                    id:icon_mudancas1
                    icon: "alpha-p-box-outline"
                    halign:"center"
                    font_size: 248
                    size_hint_x: .6
                    size_hint_y: 1

        Video:
            source:"video/close.webm"
            state:"play"
            options: {'eos': 'loop'}
            allow_strech: True



<ReverseLayout>:
    name: "reverse_screen"
    GridLayout:
        size: root.width, root.height
        cols:1
        padding: 30

        GridLayout:
            col_default_width:1
            col_default_height:0.2
            #col_force_default: True
            size_hint_y: 0.5
            padding: 30
            spacing: 20
            cols:3
            rows:1

            MDCard:
                md_bg_color: app.theme_cls.divider_color
                orientation: 'horizontal'
                MDGridLayout:
                    padding: 30
                    spaceing: 30
                    rows:1
                    cols:2

                    MDLabel:
                        id: dist3
                        text: "Bateria %"
                        font_size: 65
                        font_name: app.font1
                        size_hint_x: .65
                        size_hint_y: 1

                    MDLabel:
                        id: dist3
                        text: "23"
                        font_name: app.font1
                        font_size: 80
                        size_hint_x: .2
                        size_hint_y: 1


            MDCard:
                md_bg_color: app.theme_cls.divider_color
                orientation: 'horizontal'
                MDGridLayout:
                    padding: 30
                    spacing: 30
                    rows:1
                    cols:2

                    MDLabel:
                        text: "255"
                        font_name: app.font1
                        font_size: 200
                        halign:"center"
                        id: velocidade_label2
                        size_hint_x: .65
                        size_hint_y: 1

                    MDLabel:
                        text: "Km/h"
                        font_size: 55
                        font_name: app.font1
                        size_hint_x: .20
                        size_hint_y: 1




            MDCard:
                md_bg_color: app.theme_cls.divider_color
                orientation: 'horizontal'
                MDGridLayout:
                    padding: 30
                    spacing: 30
                    rows:1
                    cols:2

                    MDLabel:
                        id: dist1
                        text: "Distancia Retaguarda"
                        font_size: 60
                        font_name: app.font1
                        size_hint_x: .65
                        size_hint_y: 1

                    MDLabel:
                        text: "0.2 m"
                        font_name: app.font1
                        font_size: 80
                        size_hint_x: .3
                        size_hint_y: 1
        Video:
            source:"video/reverse.webm"
            state:"play"
            options: {'eos': 'loop'}
            allow_strech: True




<MyLayout>:
    name:"main_screen"
    GridLayout:
        size: root.width, root.height
        cols:3
        rows:3
        padding: 30
        spacing: 20


        MDCard:
            id: mdcard1
            md_bg_color: app.theme_cls.divider_color
            MDGridLayout:
                rows:2
                padding: 50
                #spacing: 10

                MDLabel:
                    id: contador_km_label
                    text: "0"
                    font_size: 64
                    font_name: app.font1
                    size_hint_x: .6
                    size_hint_y: 1

                MDLabel:
                    text: "Km"
                    font_name: app.font1
                    font_size: 32
                    size_hint_x: 0
                    size_hint_y: 1

                MDLabel:
                    font_size: 64
                    size_hint_x: .6
                    size_hint_y: 1



                MDLabel:
                    id: contador_parcial
                    text: "0"
                    font_name: app.font1
                    font_size: 64

                    size_hint_x: .6
                    size_hint_y: 1

                MDLabel:
                    text: "Km"
                    font_name: app.font1
                    font_size: 32

                    size_hint_x: .6
                    size_hint_y: 1

                MDIconButton:
                    id:contador_km2
                    on_press:
                        root.restart()
                    icon: "sync-circle"
                    icon_color: app.theme_cls.primary_color
                    #pos_hint: {"center_x": .5, "center_y": .5}
                    icon_size: "80dp"
                    size_hint_x: .6
                    size_hint_y: 1



        MDCard:
            md_bg_color: app.theme_cls.divider_color
            MDGridLayout:
                rows:2
                MDIcon:
                    icon: "arrow-left-bold-outline"
                    halign:"center"
                    font_size: 106
                    size_hint_x: .6
                    size_hint_y: 1
                    id:pisca_esq_icon

                MDIcon:
                    icon: "car-parking-lights"
                    halign:"center"
                    font_size: 106
                    size_hint_x: .6
                    size_hint_y: 1
                    id: lights_icon

                MDLabel:
                    icon: "arrow-right-bold-outline"
                    halign:"center"
                    font_size: 106
                    size_hint_x: .6
                    size_hint_y: 1
                    id:pisca_dir_icon


                MDIcon:
                    icon: "car-door"
                    id: icon_portas
                    halign:"center"
                    font_size: 106
                    size_hint_x: .6
                    size_hint_y: 1

                MDIcon:
                    icon: "car-windshield-outline"
                    halign:"center"
                    font_size: 106
                    size_hint_x: .6
                    size_hint_y: 1
                    id: parabrisas_icon

                MDIcon:
                    icon: "battery"
                    halign:"center"
                    font_size: 106
                    size_hint_x: .6
                    size_hint_y: 1
                    id:icon_bateria




        MDCard:
            md_bg_color: app.theme_cls.divider_color
            GridLayout:
                rows:2
                cols:2
                MDLabel:
                    text: "Autonomia Km:"
                    font_name: app.font1
                    font_size: 50
                    id: name_label2
                    halign:"center"
                MDLabel:
                    text: "0"
                    font_name: app.font1
                    font_size: 64
                    id:autonomia_km_label
                    halign:"center"

                MDLabel:
                    text: "Bateria %: "
                    font_name: app.font1
                    font_size: 50
                    id: name_label3
                    halign:"center"

                MDLabel:
                    text: "0"
                    font_size: 64
                    id: autonomia_perc_label
                    halign:"center"
                    font_name: app.font1



        BoxLayout:


        MDCard:

            id: mdcard_velocidade
            md_bg_color: app.theme_cls.divider_color
            orientation: 'horizontal'


            MDLabel:
                text: "255"
                font_name: app.font1
                font_size: 248
                halign:"center"
                id: velocidade_label
                size_hint_x: .65
                size_hint_y: 1

            MDLabel:
                text: "Km/h"
                font_size: 62
                font_name: app.font1
                size_hint_x: .20
                size_hint_y: 1


        BoxLayout:
            rows:2

        MDCard:
            md_bg_color: app.theme_cls.divider_color
            GridLayout:
                rows:2
                MDIcon:
                    id:icon_ac_i
                    icon: "air-conditioner"
                    halign:"center"
                    font_size: 106
                    size_hint_x: .5
                    size_hint_y: 1
                MDLabel:
                    text: "OFF"
                    font_name: app.font1
                    font_size: 60
                    id: ac_int_label
                    size_hint_x: .5
                    size_hint_y: 1

                MDIcon:
                    id:icon_ac_imax
                    icon: "alpha-m-circle"
                    halign:"center"
                    font_size: 106
                    size_hint_x: .5
                    size_hint_y: 1

                MDIcon:
                    id:icon_ac_t
                    icon: "thermometer-lines"
                    halign:"center"
                    font_size: 106
                    size_hint_x: .5
                    size_hint_y: 1
                MDLabel:
                    text: "OFF"
                    font_size: 60
                    id: ac_temp_label
                    font_name: app.font1
                    size_hint_x: .5
                    size_hint_y: 1

                MDIcon:
                    id:icon_solf
                    icon: "air-filter"
                    halign:"center"
                    font_size: 106
                    size_hint_x: .5
                    size_hint_y: 1

        MDCard:
            md_bg_color: app.theme_cls.divider_color
            GridLayout:
                cols:2
                MDIcon:
                    id:icon_warns
                    icon: "alert-octagon-outline"
                    halign:"center"
                    font_size: 212
                    size_hint_x: .5
                    size_hint_y: 1
                MDCard:
                    id:mdcard_warns
                    size_hint_x: .5
                    size_hint_y: 1
                    md_bg_color: app.theme_cls.divider_color
                    elevation: 150
                    MDLabel:
                        text: ""
                        font_name: app.font3
                        font_size: 50
                        id: warnings
                        halign:"center"
                        size_hint_x: .5
                        size_hint_y: 1

        MDCard:
            md_bg_color: app.theme_cls.divider_color
            orientation: 'horizontal'
            style: "outlined"


            MDIcon:

                icon: "car-shift-pattern"
                halign:"center"
                font_size: 124
                size_hint_x: .5
                size_hint_y: 1


            MDIcon:
                id:icon_mudancas
                icon: "alpha-p-box-outline"
                halign:"center"
                font_size: 248
                size_hint_x: .6
                size_hint_y: 1



<MyWidget>
    MDNavigationLayout:
        ScreenManager:
            Screen:
                MDBoxLayout:
                    orientation: 'vertical'
                    size: root.width, root.height
                    MDToolbar:
                        title: app.hours
                        id:time
                        font_name: app.font1
                        #md_bg_color: .2, .2, .3, .5
                        left_action_items: [['menu', lambda x: nav_drawer.set_state("open")]]

                    MDBottomNavigation:
                        panel_color: rgba('262626')
                        MDBottomNavigationItem:
                            id:nav1
                            name: "Dashboardscreen"
                            text: "Dashboard"
                            icon: 'car'

                            WindowManager:


                        MDBottomNavigationItem:
                            name: "GPSscreen"
                            text: "GPS"
                            icon: 'compass-outline'
                            Gps:

        MDNavigationDrawer:
            id: nav_drawer
            ContentNavigationDrawer:









<ContentNavigationDrawer>:
    id:nav_drawer
    padding: "16dp"
    spacing: "32dp"
    orientation: 'vertical'

    OneLineIconListItem:
        #text: "Definições"
        text: "[size=19]Definições"
        IconLeftWidget:
            icon: 'cog-outline'
            #user_font_size: 34

    GridLayout:
        cols:3
        width: 200
        spacing: "32dp"


        MDIcon:
            icon:'bell-alert-outline'
            size_hint_y: None
            size_hint_x: 0.3
            height: 600
        MDLabel:
            text: "Desativar notificações"
            font_size: 15
            size_hint_y: None
            height: 30
        MDSwitch:
            id:switch1
            active:True
            on_active: root.switch_click1(self, self.active)
            width: '32px'
            size_hint_y: None
            height: 30


        MDIcon:
            icon:'moon-waning-crescent'
            size_hint_y: None
            size_hint_x: 0.3
            height: 600
        MDLabel:
            text: "Modo Noturno"
            font_size: 15
            size_hint_y: None
            height: 30
        MDSwitch:
            id:switch2
            active:True
            on_state:
            on_active:

                if switch2.active==False:\
                app.theme_cls.theme_style = 'Light'
                if switch2.active==False:\
                app.theme_cls.primary_palette = "BlueGray"
                #if switch2.active==False:\
                #app.root.ids.nav1.md_bg_color:(1, .5, 1, .5)


                if switch2.active==True:\
                app.theme_cls.theme_style = 'Dark'
                if switch2.active==True:\
                app.theme_cls.primary_palette = "BlueGray"
                #if switch2.active==True:\
                #app.root.ids.nav1.md_bg_color:(0, 0.3, 0.9, 0.9)

            width: '32px'
            size_hint_y: None
            height: 30
